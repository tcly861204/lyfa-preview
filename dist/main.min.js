!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Preview=t()}(this,(function(){"use strict";const e=e=>i.dom.querySelector(e),t=function(e,t,n){e&&t&&n&&e.addEventListener(t,n,!1)},n=function(e,t,n){e&&t&&e.removeEventListener(t,n,!1)},i={app:null,index:0,len:0,list:[],dom:null,imgWidth:null,imgHeight:null,rotateNum:0,scaleNum:1,imgLeft:0,imgTop:0,fullScreen:!0,btns:{prev:null,next:null}};class l{static handleKeyEvents(e){try{switch(e.code.toLocaleLowerCase()){case"escape":window.removeEventListener("keydown",l.handleKeyEvents,!1),i.dom.parentNode.removeChild(i.dom);break;case"keya":case"arrowleft":l.handlePrev();break;case"keyd":case"arrowright":l.handleNext()}}catch(t){}}static updateScreen(){const t=e(".swipper img"),n=e(".action-item.fullsceen .icon");i.fullScreen=parseInt(t.style.width)>=window.innerWidth||parseInt(t.style.height)>=window.innerHeight,n.style.backgroundPosition=""+(i.fullScreen?"-28px -27px":"-28px 0")}static handlePrev(){const e=0===i.index?i.len-1:i.index-1;i.app.display(e)}static handleNext(){const e=i.index===i.len-1?0:i.index+1;i.app.display(e)}static handleFullScreen(){const t=e(".action-item.fullsceen .icon"),n=e(".swipper img");let l=1,s=1;i.fullScreen?(i.fullScreen=!1,l=(window.innerHeight-140)/i.imgHeight,s=(window.innerWidth-140)/i.imgWidth,i.scaleNum=s>l?l:s):(i.fullScreen=!0,l=window.innerHeight/i.imgHeight,s=window.innerWidth/i.imgWidth,i.scaleNum=s>l?s:l);const o=i.imgWidth*i.scaleNum,c=i.imgHeight*i.scaleNum;i.imgLeft=(window.innerWidth-o)/2,i.imgTop=(window.innerHeight-c)/2,n.style.width=`${o}px`,n.style.height=`${c}px`,n.style.top=`${i.imgTop}px`,n.style.left=`${i.imgLeft}px`,t.style.backgroundPosition=""+(i.fullScreen?"-28px -27px":"-28px 0")}static handleRotate(){const t=e(".swipper img");i.rotateNum-=90,t.style.transform=`rotate(${i.rotateNum}deg)`}static handlerZoom(t){const n=e(".swipper img");if("in"===t){if(!(i.scaleNum+.2<3))return!1;i.scaleNum+=.2}if("out"===t){if(!(i.scaleNum-.2>.2))return!1;i.scaleNum-=.2}const l=i.imgWidth*i.scaleNum,s=i.imgHeight*i.scaleNum;i.imgLeft=i.imgLeft+(parseInt(n.style.width)-l)/2,i.imgTop=i.imgTop+(parseInt(n.style.height)-s)/2,n.style.width=`${l}px`,n.style.height=`${s}px`,n.style.top=`${i.imgTop}px`,n.style.left=`${i.imgLeft}px`,this.updateScreen()}}var s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIYAAAAzCAYAAABSfnBXAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3FpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyY2U1ODBmMi04NGJmLTA1NGUtODYzMC1jMmJlOWJiZjExYjAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjY3OEE5QzI0NTJGMTFFQ0JBODlGNjA0NTc5MkJDRkEiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjY3OEE5QzE0NTJGMTFFQ0JBODlGNjA0NTc5MkJDRkEiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjk4Y2Y1MDY2LTEwNWUtYzQ0Ni1hYTZmLWMyZmI1NjA3MDhkNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoyY2U1ODBmMi04NGJmLTA1NGUtODYzMC1jMmJlOWJiZjExYjAiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6V3BHuAAAFZklEQVR42uycXWgcVRTHZ7spRhtqbaVBUCzEh/gghRKU2AcxSEVBlGjzoMQ+hEQUS5HEPlgEsRalm60+CGqJUoliWY2+WSooPlgrKBb0IQEp/fClTVChtlaabKf/w/6HXsadZma8s7t35xz4MR/33jMfe+bMvWfu2YLv+56KSlhW6C1QUcNQUcOIKYNgCsyCS1xOcb8aRkj8EGn3xxU/grT14kg3KIEKGAG9YCWXI9xfYj3bsgeszUDvczzvpFJh29DdRuczRFjS7o9LlKStF4eS0X4GjIBeLmeMslJK/VEcAlUwalmvR70ilQRtKmxTDZe1kmE0qt0gWGLbCVAMlRe532e9QYs/3gFwDiyAXWC9Rd2bqTuucQRGcY5tc28YU4anKIb0mcYReI4py0+2eKV/DMO0qbsvpnGYRtFXr069PkYhRNr9rSqbufwSVCPqVFlu1rclB8E+ru8Eo6DTku6fwABYAlvBIugzyvu4byvrDLCNF6eP0Wga7TEusV3vNfouHst91rd9zdeDMXCWx9gDuix7jkXqXuR2vX2ROlphVJLW06RtdzzkCUw9wfoKo/x4Bl7rItgP9nJ7HDxlUb94gX56hQ7wA+ngvv5IT5HjOMYRLh8GxYg614FHQvWzkGnwMt37O5Z1B8ZR5XUWub6sUeTVMIK+hQSxXjCMI/Aasr0DPAouG30NjXy2uXwO3uR6OMgVBLdeZ7lEQ1dleC7DYDeDa89a1i0dzaOGpwg8x9FQh9TTzudVuhm8WorofMr+Oa5fBsN563zm1TDMYJfEKWY5+pjldhDUmjeMY5ul610FXqPeeUZBOzM2ijhluQ9wJeV341j35SXApYaRzDgugLs1JN6+H9HS8DOPJ0/76nb/iKYTdeLLJvAp+BfclVLHQ+ANMJPB+W3n+Q0laDPENtv/Ez3UOZ+J5XnwGTjTzhephqGiAS4VNQwVNQwVNQwVNQwVNQwVNQyVdjaMNeBjvXVqGKbcD34BT7bJ9WuKYpTE/Ngi8wUmjQ81ImWwpYHzM2x+NIszUafEell/nFvLiTpeK7HchJIC1z+KuIF/02A2OGYYzUpRrMcoH7hDLhhGD9jBJ6ZAj1EOeYzDxvq0RePI2jCamaJosp5zMhY4J+KAC4ZR4aSUd8E6w3MMgNO8aTJHcRyc4PakI4YRlaLoNShFMWDCmN8x0mqvknqdzwnwBLjBq02f/8O7mkj0DdgIPgHnQRm8zbJnwJY03RwvWcLS/01wanaKoqQjSlriTm5LuuJBF0Yla3jDZb7BK3XK/wqNSt4DX4Eu8KAD/e0eLo9EGJofKu+xeGy5R5JgtJ/HkYdJ/i/jgguGITfkrFfLkpqPoUM8x2Gu35viHAoRpK23nESlKJpklaIoaYjjXN9LA7noShzjO3APeDWBnu+5vNMBj9HMFEVJQ1yk15h2LcDVwUDWjW0auolKUQxEUxQjDONr8CF4K4Ge4BUy68A1NzNFUdIQJR1R0hKHXYt8/shh1ElwU4yhTZcR0yg7kj7QrBTFLkY5faYnjjFd0XNhuCpPlPyHwm/g9hi2FQxTzU5oq4t0rl/0atPn3wdzfPfPcXuIHmSBnVHxoNssHPc8vcUY9cqIbpeXbeK01W8l+8AtYCXYCG6uU2cdI3euBbianaLoRIDrWh92OnkjToEz4AujvB/86mhIvJkpis6ExKM+u//JUYl0xm71an+E+phRLn/qdQeDNGUOv062cSf9NnCM0eBvwWoLOucZ3HqJr5LuVrrgjmXew09zpPE4I6KByLv4A3ACTOZkBLeJI5YHvFqKoq34hqQrbmBfo2VEM9GSi6YoquRXdDKwihqGSny5IsAAQEF7ge9LblUAAAAASUVORK5CYII=";class o{constructor(){this.init(),t(window,"keydown",l.handleKeyEvents),function(){const n=e(".next");n.style.display=i.len>1?"block":"none",t(n,"click",l.handleNext)}(),function(){const n=e(".prev");n.style.display=i.len>1?"block":"none",t(n,"click",l.handlePrev)}(),function(){const s=e("div.close");t(s,"click",(()=>{try{n(window,"keydown",l.handleKeyEvents),i.dom.parentNode.removeChild(i.dom)}catch(e){}}))}(),function(){const n=e(".action-item.fullsceen"),i=e(".action-item.zoomIn"),s=e(".action-item.zoomOut"),o=e(".action-item.rotate");t(n,"click",l.handleFullScreen),t(o,"click",l.handleRotate),t(i,"click",(()=>l.handlerZoom("in"))),t(s,"click",(()=>l.handlerZoom("out")))}()}init(){i.dom=document.createElement("div"),i.dom.className="preview-container__mask",i.dom.innerHTML=`<section class="preview-container">\n      \n    <header class="preview-container__header">\n      <h2 class="title"></h2>\n      <div class="icon close" style="background-image: url(${s});"></div>\n    </header>\n  \n      \n    <section class="preview-container__body">\n      <div class="preview-container__body-btn prev">\n        <span class="icon" style="background-image: url(${s})"></span>\n      </div>\n      <div class="swipper">\n      </div>\n      <div class="preview-container__body-btn next">\n        <span class="icon" style="background-image: url(${s})"></span>\n      </div>\n    </section>\n  \n      <footer class="preview-container__footer">\n    <section class="preview-container__footer-action">\n      <ul>\n        <li class="action-item app" data-num="0/0"><span class="icon" style="background-image: url(${s})"></span></li>\n        <li class="action-item fullsceen"><span class="icon" style="background-image: url(${s})"></span></li>\n        <li class="action-item zoomIn"><span class="icon" style="background-image: url(${s})"></span></li>\n        <li class="action-item zoomOut"><span class="icon" style="background-image: url(${s})"></span></li>\n        <li class="action-item rotate"><span class="icon" style="background-image: url(${s})"></span></li>\n      </ul>\n    </section>\n  </footer>\n    </section>`,document.body.appendChild(i.dom)}}return class extends class{constructor(){this.winWidth=window.innerWidth,this.winHeight=window.innerHeight,this.isLayout=!1}updateNum(){e(".action-item.app").setAttribute("data-num",`${i.index+1}/${i.len}`)}updateTitle(t){e("h2.title").innerHTML=t.name}render(t){e(".swipper").innerHTML='<div class="loading"></div>';const n=new Image,l=this;n.src=t.src,n.onload=function(){const e=n.width,s=n.height;if(i.imgWidth=e,i.imgHeight=s,e>l.winWidth-140||s>l.winHeight-140){const t=(l.winHeight-140)/s,n=(l.winWidth-140)/e;i.scaleNum=n>t?t:n,i.fullScreen=!1,i.imgLeft=(l.winWidth-e*i.scaleNum)/2,i.imgTop=(l.winHeight-s*i.scaleNum)/2}else i.fullScreen=!1,i.imgLeft=(l.winWidth-e)/2,i.imgTop=(l.winHeight-s)/2;l.renderImage(t,e,s)}}renderImage(n,s,o){const c=document.createElement("img");let a=null;c.src=n.src,c.setAttribute("style",`\n      position: absolute;\n      width: ${s*i.scaleNum}px;\n      height: ${o*i.scaleNum}px;\n      top: ${i.imgTop}px;\n      left: ${i.imgLeft}px;\n      cursor: pointer;\n      transition: all ease-in-out .4s;\n    `),c.addEventListener("mousedown",(function(e){e.preventDefault(),this.style.cursor="move",this.style.transition="none";const t=e.clientX,n=e.clientY,l=i.imgLeft,s=i.imgTop;document.onmousemove=e=>{i.imgLeft=l+(e.clientX-t),i.imgTop=s+(e.clientY-n),this.style.left=`${i.imgLeft}px`,this.style.top=`${i.imgTop}px`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null,this.style.cursor="pointer",this.style.transition="all ease-in-out .4s"}}),!1),t(c,"mousewheel",(function(e){e.preventDefault();const[t,n,l]=[i.scaleNum,e.clientX-i.imgLeft,e.clientY-i.imgTop];this.style.transition="none",e.deltaY<0?(a=.08,t>10&&(a=0)):(a=-.08,t<.2&&(a=0)),i.scaleNum+=a,i.imgTop-=(i.scaleNum/t-1)*l,i.imgLeft-=(i.scaleNum/t-1)*n,this.style.left=`${i.imgLeft}px`,this.style.top=`${i.imgTop}px`,this.style.width=s*i.scaleNum+"px",this.style.height=o*i.scaleNum+"px"})),t(c,"mouseout",(function(e){this.style.transition.indexOf("none")>-1&&(this.style.transition="all ease-in-out .4s")}));const d=setTimeout((()=>{clearTimeout(d);const t=e(".swipper");t.innerHTML="",t.appendChild(c),l.updateScreen()}),100)}}{constructor(e){super(),i.app=this,i.index=0,i.list=e.list,i.len=i.list.length}display(e=0){i.index=e>i.len-1?0:e,this.isLayout||(this.isLayout=!0,new o),this.updateNum();try{const e=i.list[i.index];if(this.updateTitle(e),i.rotateNum=0,i.scaleNum=1,i.imgLeft=0,i.imgTop=0,i.fullScreen=!0,e.ext)switch(e.ext.toLocaleLowerCase()){case"jpeg":case"jpg":case"png":case"gif":this.render(e);break;default:console.log("暂不支持图片以外格式预览")}}catch(t){}}}}));
